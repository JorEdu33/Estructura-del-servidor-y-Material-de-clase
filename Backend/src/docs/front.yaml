tags:
  - name: Frontend
    description: Endpoints para la consulta de información desde el frontend (grupos, semanas, detalles e intentos).

paths:
  /api/grupos:
    get:
      summary: Obtener lista de grupos
      description: |
        Devuelve un arreglo con los nombres de todos los grupos registrados en el sistema.
        
        **Nota:** Solo incluye grupos que no sean nulos ni vacíos, ordenados alfabéticamente.
      tags: [Frontend]
      operationId: getGrupos
      responses:
        200:
          description: Lista de grupos obtenida correctamente
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                example: ["A1", "B2", "C3"]
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/semanas/{grupo}:
    get:
      summary: Obtener resumen de semanas por grupo
      description: |
        Devuelve un objeto donde cada clave es una semana (número) y el valor es un arreglo de estudiantes 
        con sus mejores notas por ejercicio en esa semana.
        
        **Agrupación:** Los datos se agrupan por estudiante, ejercicio y semana.
      tags: [Frontend]
      operationId: getSemanasPorGrupo
      parameters:
        - $ref: '#/components/parameters/GrupoParameter'
      responses:
        200:
          description: Resumen semanal obtenido exitosamente
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: array
                  items:
                    $ref: '#/components/schemas/ResumenSemanal'
              example:
                36:
                  - codigo_estudiante: "20251234"
                    nombre_estudiante: "Jorge Suárez"
                    grupo: "A1"
                    ejercicio: "Ejercicio 3 - Regresión Lineal"
                    mejor_nota: 4.5
                  - codigo_estudiante: "20251235"
                    nombre_estudiante: "María López"
                    grupo: "A1"
                    ejercicio: "Ejercicio 1 - Análisis Descriptivo"
                    mejor_nota: 5.0
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/detalle/{semana}/{codigo_estudiante}:
    get:
      summary: Obtener detalles de intentos por semana y código de estudiante
      description: |
        Devuelve la lista completa de intentos realizados por un estudiante específico 
        en una semana determinada, ordenados cronológicamente.
        
        **Incluye por cada intento:**
        - Ejercicio realizado
        - Nota obtenida
        - Código/solución enviada por el estudiante
        - Fecha y hora del intento
        
        **Nota:** El campo `codigo` contiene la solución enviada por el estudiante, 
        no su identificador.
      tags: [Frontend]
      operationId: getDetallePorSemanaYCodigo
      parameters:
        - $ref: '#/components/parameters/SemanaParameter'
        - $ref: '#/components/parameters/CodigoEstudianteParameter'
      responses:
        200:
          description: Lista de intentos obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DetalleIntento'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/detalle/{id}:
    delete:
      summary: Eliminar intento por ID
      description: |
        Elimina permanentemente un intento específico (registro en la tabla ejercicios) 
        identificado por su ID único.
        
        **Advertencia:** Esta operación eliminará tanto el registro del intento 
        como la solución/código enviado por el estudiante. No se puede deshacer.
      tags: [Frontend]
      operationId: deleteDetalleById
      parameters:
        - $ref: '#/components/parameters/IdIntentoParameter'
      responses:
        200:
          description: Intento y solución asociada eliminados correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/asignar-ceros:
    post:
      summary: Asignar ceros a ejercicios faltantes
      description: |
        Asigna calificación de cero (0) a todos los ejercicios de la semana que los estudiantes 
        de un grupo no hayan realizado.
        
        **Funcionamiento:**
        1. Obtiene todos los estudiantes del grupo especificado
        2. Identifica los ejercicios registrados en esa semana para el grupo
        3. Para cada estudiante, detecta los ejercicios que no haya realizado
        4. Inserta registros con nota 0 para los ejercicios faltantes
        
        **Nota:** Utiliza la fecha de inicio de la semana (lunes) como timestamp para los registros insertados.
      tags: [Frontend]
      operationId: asignarCeros
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AsignarCerosRequest'
            example:
              semana: 36
              grupo: "A1"
      responses:
        200:
          description: Ceros asignados exitosamente a los ejercicios faltantes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AsignarCerosResponse'
              example:
                message: "✅ Se asignaron ceros a los ejercicios faltantes de la semana 36 en el grupo A1."
                fecha_usada: "2025-09-01T00:00:00.000Z"
                resumen:
                  - codigo_estudiante: "20251234"
                    ejercicios_faltantes: 
                      - "Ejercicio 3 - Regresión Lineal"
                      - "Ejercicio 4 - ANOVA"
                  - codigo_estudiante: "20251235"
                    ejercicios_faltantes:
                      - "Ejercicio 3 - Regresión Lineal"
        400:
          $ref: '#/components/responses/ValidationError'
        404:
          description: Recurso no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "No hay estudiantes en el grupo A1."
              examples:
                sinEstudiantes:
                  summary: Grupo sin estudiantes
                  value:
                    message: "No hay estudiantes en el grupo A1."
                sinEjercicios:
                  summary: Sin ejercicios registrados
                  value:
                    message: "No hay ejercicios registrados en la semana 36 para el grupo A1."
        500:
          $ref: '#/components/responses/InternalServerError'